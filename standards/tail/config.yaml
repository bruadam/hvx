id: "tail"
name: "TAIL Indoor Environmental Quality Rating"
version: "2024.1"
standard_type: "TAIL"
description: "TAIL rating scheme for comprehensive indoor environmental quality assessment across Thermal, Acoustic, Indoor Air Quality, and Luminous domains"

# Rating-based standard (not category-based like EN16798)
category_based: false

# TAIL rating scale
ratings:
  - id: "I"
    value: 1
    name: "Rating I - Excellent"
    description: "Green - High quality (≥95% compliant)"
    color: "green"
    min_compliance: 95.0

  - id: "II"
    value: 2
    name: "Rating II - Good"
    description: "Yellow - Good quality (70-95% compliant)"
    color: "yellow"
    min_compliance: 70.0

  - id: "III"
    value: 3
    name: "Rating III - Fair"
    description: "Orange - Fair quality (50-70% compliant)"
    color: "orange"
    min_compliance: 50.0

  - id: "IV"
    value: 4
    name: "Rating IV - Poor"
    description: "Red - Poor quality (<50% compliant)"
    color: "red"
    min_compliance: 0.0

# TAIL categories (domains)
domains:
  - id: "thermal"
    name: "Thermal Comfort"
    description: "Temperature and humidity conditions"
    metrics:
      - temperature
      - humidity

  - id: "acoustic"
    name: "Acoustic Comfort"
    description: "Noise levels and sound environment"
    metrics:
      - noise
      - sound_level

  - id: "iaq"
    name: "Indoor Air Quality"
    description: "Air quality parameters"
    metrics:
      - co2
      - pm25
      - pm10
      - voc
      - tvoc
      - formaldehyde

  - id: "luminous"
    name: "Luminous Comfort"
    description: "Light levels and daylight"
    metrics:
      - illuminance
      - daylight_factor

# Applicability
applicability:
  countries: null  # Universal standard
  regions: null
  building_types: ["office", "school", "residential", "commercial"]
  seasons: ["all_year"]

# Required inputs (at least one from each domain for complete assessment)
required_inputs:
  thermal:
    temperature: true
    humidity: false
  acoustic:
    noise: false
  iaq:
    co2: true
    pm25: false
  luminous:
    illuminance: false

# Default thresholds for parameters
default_thresholds:
  # Thermal domain
  temperature:
    lower_bound: 20.0
    upper_bound: 26.0
    unit: "°C"
    domain: "thermal"
    description: "Operative temperature range"

  humidity:
    lower_bound: 30.0
    upper_bound: 60.0
    unit: "%"
    domain: "thermal"
    description: "Relative humidity range"

  # Acoustic domain
  noise:
    upper_bound: 45.0
    unit: "dB(A)"
    domain: "acoustic"
    description: "Maximum continuous noise level"

  sound_level:
    upper_bound: 45.0
    unit: "dB(A)"
    domain: "acoustic"
    description: "Equivalent continuous sound level"

  # Indoor Air Quality domain
  co2:
    upper_bound: 1000.0
    unit: "ppm"
    domain: "iaq"
    description: "CO2 concentration above outdoor"

  pm25:
    upper_bound: 25.0
    unit: "μg/m³"
    domain: "iaq"
    description: "PM2.5 particulate matter"

  pm10:
    upper_bound: 50.0
    unit: "μg/m³"
    domain: "iaq"
    description: "PM10 particulate matter"

  voc:
    upper_bound: 300.0
    unit: "μg/m³"
    domain: "iaq"
    description: "Total volatile organic compounds"

  tvoc:
    upper_bound: 300.0
    unit: "μg/m³"
    domain: "iaq"
    description: "Total VOC concentration"

  # Luminous domain
  illuminance:
    lower_bound: 300.0
    upper_bound: 2000.0
    unit: "lux"
    domain: "luminous"
    description: "Illuminance on work plane"

  daylight_factor:
    lower_bound: 2.0
    unit: "%"
    domain: "luminous"
    description: "Daylight factor"

# Building type specific thresholds
building_type_thresholds:
  office:
    temperature:
      lower_bound: 20.0
      upper_bound: 24.0
    co2:
      upper_bound: 1000.0
    illuminance:
      lower_bound: 500.0
      upper_bound: 2000.0
    noise:
      upper_bound: 40.0

  school:
    temperature:
      lower_bound: 20.0
      upper_bound: 24.0
    co2:
      upper_bound: 1200.0
    illuminance:
      lower_bound: 300.0
      upper_bound: 1500.0
    noise:
      upper_bound: 35.0

  residential:
    temperature:
      lower_bound: 19.0
      upper_bound: 26.0
    co2:
      upper_bound: 1200.0
    illuminance:
      lower_bound: 200.0
      upper_bound: 1000.0
    noise:
      upper_bound: 45.0

# Aggregation configuration for multi-level analysis
aggregation:
  # Method for aggregating ratings across rooms/floors to building level
  # Options: "worst", "average", "weighted_average"
  spatial_method: "worst"
  
  # Method for aggregating domains (thermal, acoustic, iaq, luminous) within a room
  # Options: "worst", "average", "weighted"
  domain_method: "worst"
  
  # Target metric for aggregation (overall rating)
  metric: "rating"
  
  # Weighting for weighted domain aggregation
  domain_weights:
    thermal: 0.35
    acoustic: 0.20
    iaq: 0.30
    luminous: 0.15
  
  # Weight properties for spatial weighted aggregation
  weight_properties:
    - area_m2
    - design_occupancy
  
  # Levels where aggregation is performed
  rollup_targets:
    - room      # Aggregate domains within room
    - floor     # Aggregate rooms to floor level
    - building  # Aggregate floors to building level
    - portfolio # Aggregate buildings to portfolio level
  
  # Spatial scope
  run_on_types:
    - room
  
  rollup_from_children:
    - room
    - floor
  
  aggregate_to_types:
    - floor
    - building
    - portfolio

# Compliance calculation settings
compliance_settings:
  # Minimum data points required for valid assessment
  min_data_points: 100

  # Time window for assessment
  assessment_window: "P1Y"  # ISO 8601 duration (1 year)

  # Tolerance for exceedances
  tolerance_percentage: 5.0  # Allow 5% exceedance

# Analysis module
analysis_module: "standards.tail.analysis:run"
